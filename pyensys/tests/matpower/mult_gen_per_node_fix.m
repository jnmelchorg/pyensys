%% generator data																						
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf																						
gen_data = [																						
	1	396.774	-49.18	139.2209046	-188.4590954	1	100	1	493.5	0	0	0	0	0	0	0	0	0	0	0	0
	1	441.86232	0	105.2292729	-66.29666644	1	100	1	549.58	0	0	0	0	0	0	0	0	0	0	0	0
	1	0	0	180	-100	1	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0
	1	15.05088	0	7.8	-8.99	1	100	1	18.72	0	0	0	0	0	0	0	0	0	0	0	0
	2	29.28972	0	14.328265	-17.671735	1	100	1	36.43	0	0	0	0	0	0	0	0	0	0	0	0
	2	1225.296	267.04	1108.510424	-473.3565078	1	100	1	1524	0	0	0	0	0	0	0	0	0	0	0	0
	2	9.648	0	0	0	1	100	1	12	0	0	0	0	0	0	0	0	0	0	0	0
	3	311.8716	128.3364	128.3364217	-158.1387783	1	100	1	387.9	0	0	0	0	0	0	0	0	0	0	0	0
	3	10.88616	0	-3.51124	-3.51124	1	100	1	13.54	0	0	0	0	0	0	0	0	0	0	0	0
	3	444.612	124.3	144.7939487	-66.16987334	1	100	1	553	0	0	0	0	0	0	0	0	0	0	0	0
	3	12.15648	0	6.5071	-7.2929	1	100	1	15.12	0	0	0	0	0	0	0	0	0	0	0	0
	4	20.2608	0	10.65561979	-12.34438021	1	100	1	25.2	0	0	0	0	0	0	0	0	0	0	0	0
	4	1836.336	597.14	641.4683118	-679.0037586	1	100	1	2284	0	0	0	0	0	0	0	0	0	0	0	0
	4	273.36	0	150.34	-137.8599087	1	100	1	340	0	0	0	0	0	0	0	0	0	0	0	0
	4	208.236	0	137.27	-122.95	1	100	1	259	0	0	0	0	0	0	0	0	0	0	0	0
	5	863.496	-28.9	416.4725632	-429.7731578	1	100	1	1074	0	0	0	0	0	0	0	0	0	0	0	0
	5	18.6528	0	15.38765205	-9.937777586	1	100	1	23.2	0	0	0	0	0	0	0	0	0	0	0	0
	6	805.22208	244.84	439.66182	-484.8030489	1	100	1	1001.52	0	0	0	0	0	0	0	0	0	0	0	0
	6	26.532	0	24.8	-25.5	1	100	1	33	0	0	0	0	0	0	0	0	0	0	0	0
	6	39.7176	0	12.0901377	-17.4898623	1	100	1	49.4	0	0	0	0	0	0	0	0	0	0	0	0
	7	182.3472	-111.07	125.7559808	-131.0176558	1	100	1	226.8	0	0	0	0	0	0	0	0	0	0	0	0
	7	977.664	0	681.3407231	-469.0728269	1	100	1	1216	0	0	0	0	0	0	0	0	0	0	0	0
	7	887.616	0	220.3438921	-205.2405431	1	100	1	1104	0	0	0	0	0	0	0	0	0	0	0	0
	10	971.232	233.67	559.1941175	-539.6840776	1	100	1	1208	0	0	0	0	0	0	0	0	0	0	0	0
	10	1507.5	0	697.1712682	-829.6266854	1	100	1	1875	0	0	0	0	0	0	0	0	0	0	0	0
	10	337.68	0	167.9526233	-138.0443168	1	100	1	420	0	0	0	0	0	0	0	0	0	0	0	0
	11	104.77728	0	-57.6	-57.6	1	100	1	130.32	0	0	0	0	0	0	0	0	0	0	0	0
	11	1934.424	1189.27	1216.095081	-1006.32167	1	100	1	2406	0	0	0	0	0	0	0	0	0	0	0	0
	11	1576.644	0	873.2160163	-571.4617135	1	100	1	1961	0	0	0	0	0	0	0	0	0	0	0	0
	11	124.62	0	94.22483304	-75.20860942	1	100	1	155	0	0	0	0	0	0	0	0	0	0	0	0
	11	835.356	0	670.3158949	-539.0705317	1	100	1	1039	0	0	0	0	0	0	0	0	0	0	0	0
	12	787.92	357.62	579.9839977	-418.117905	1	100	1	980	0	0	0	0	0	0	0	0	0	0	0	0
	12	1515.54	0	960.0493991	-853.0598839	1	100	1	1885	0	0	0	0	0	0	0	0	0	0	0	0
	12	168.84	0	116.4182172	-94.96519991	1	100	1	210	0	0	0	0	0	0	0	0	0	0	0	0
	12	881.184	0	344.4771874	-575.5228126	1	100	1	1096	0	0	0	0	0	0	0	0	0	0	0	0
	15	6271.2	1243.37	3535.031883	-2527.871669	1	100	1	7800	0	0	0	0	0	0	0	0	0	0	0	0
	16	3193.488	0	1587.056017	-1289.624064	1	100	1	3972	0	0	0	0	0	0	0	0	0	0	0	0
	16	5660.964	3118.9	3653.234202	-3354.578181	1	100	1	7041	0	0	0	0	0	0	0	0	0	0	0	0
	16	979.272	0	767.3265276	-562.8491075	1	100	1	1218	0	0	0	0	0	0	0	0	0	0	0	0
	17	1608	356.18	814.2321995	-405.9415934	1	100	1	2000	0	0	0	0	0	0	0	0	0	0	0	0
	18	1575.84	-45.33	884.9714977	-534.171232	1	100	1	1960	0	0	0	0	0	0	0	0	0	0	0	0
	18	183.312	0	40.02176281	-73.57823719	1	100	1	228	0	0	0	0	0	0	0	0	0	0	0	0
	19	2287.38	1201.13	1336.631772	-1468.981903	1	100	1	2845	0	0	0	0	0	0	0	0	0	0	0	0
	19	327.0672	0	162.7	-162.7	1	100	1	406.8	0	0	0	0	0	0	0	0	0	0	0	0
	20	964.8	304.42	621.1413306	-523.3801299	1	100	1	1200	0	0	0	0	0	0	0	0	0	0	0	0
	20	289.44	0	236.64	236.64	1	100	1	360	0	0	0	0	0	0	0	0	0	0	0	0
	21	534.66	326	326.1499173	-306.0698826	1	100	1	665	0	0	0	0	0	0	0	0	0	0	0	0
	22	322.4844	130.03	189.7190044	-232.6810031	1	100	1	401.1	0	0	0	0	0	0	0	0	0	0	0	0
	23	3032.688	1254.4	1589.66533	-1388.267098	1	100	1	3772	0	0	0	0	0	0	0	0	0	0	0	0
	23	291.852	0	84.80580067	-153.9941993	1	100	1	363	0	0	0	0	0	0	0	0	0	0	0	0
	23	377.88	0	317.7576473	-211.4291086	1	100	1	470	0	0	0	0	0	0	0	0	0	0	0	0
	23	2477.13204	0	1200.813571	-1262.242187	1	100	1	3081.01	0	0	0	0	0	0	0	0	0	0	0	0
	25	1706.892	941	949.3783757	-947.4163172	1	100	1	2123	0	0	0	0	0	0	0	0	0	0	0	0
	25	0	0	0	0	1	100	1	100	0	0	0	0	0	0	0	0	0	0	0	0
	26	1559.76	434.93	881.4439996	-431.3501824	1	100	1	1940	0	0	0	0	0	0	0	0	0	0	0	0
	26	887.616	0	384.1098821	-294.6218936	1	100	1	1104	0	0	0	0	0	0	0	0	0	0	0	0
	26	1981.86	0	1254.526922	-1114.638015	1	100	1	2465	0	0	0	0	0	0	0	0	0	0	0	0
	26	0	0	0	0	1	100	1	100	0	0	0	0	0	0	0	0	0	0	0	0
	27	869.928	416.22	666.0315259	-541.7921399	1	100	1	1082	0	0	0	0	0	0	0	0	0	0	0	0
	27	173.664	0	71	0	1	100	1	216	0	0	0	0	0	0	0	0	0	0	0	0
	28	1061.28	248.31	657.8243073	-579.7019351	1	100	1	1320	0	0	0	0	0	0	0	0	0	0	0	0
	28	167.232	0	60.79357628	-71.20642372	1	100	1	208	0	0	0	0	0	0	0	0	0	0	0	0
	29	1013.844	-480.42	455.3171992	-480.4288183	1	100	1	1261	0	0	0	0	0	0	0	0	0	0	0	0
	29	727.62	-159.48	403.3543544	-412.0264373	1	100	1	905	0	0	0	0	0	0	0	0	0	0	0	0
	29	727.62	-159.48	403.3543544	-412.0264373	1	100	1	905	0	0	0	0	0	0	0	0	0	0	0	0 
	24	0	0	949.4 -949.4	1	100	1	2000 	0	0	0	0	0	0	0	0	0	0	0	0 
	];																						

gencost_data = [										%
	2	0	0	2	0.1	0
	2	0	0	2	0.2	0
	2	0	0	2	70	0
	2	0	0	2	70	0
	2	0	0	2	10	0
	2	0	0	2	38.05	0
	2	0	0	2	69.76	0
	2	0	0	2	0.3	0
	2	0	0	2	0.4	0
	2	0	0	2	0.5	0
	2	0	0	2	70	0
	2	0	0	2	0.6	0
	2	0	0	2	46	0
	2	0	0	2	70	0
	2	0	0	2	69.76	0
	2	0	0	2	0.7	0
	2	0	0	2	38.05	0
	2	0	0	2	0.8	0
	2	0	0	2	0.9	0
	2	0	0	2	70	0
	2	0	0	2	1.1	0
	2	0	0	2	1.2	0
	2	0	0	2	46	0
	2	0	0	2	1.3	0
	2	0	0	2	38.05	0
	2	0	0	2	46	0
	2	0	0	2	1.4	0
	2	0	0	2	1.5	0
	2	0	0	2	46	0
	2	0	0	2	69.76	0
	2	0	0	2	38.05	0
	2	0	0	2	1.6	0
	2	0	0	2	38.05	0
	2	0	0	2	69.76	0
	2	0	0	2	70	0
	2	0	0	2	46	0
	2	0	0	2	46	0
	2	0	0	2	38.05	0
	2	0	0	2	69.76	0
	2	0	0	2	46	0
	2	0	0	2	46	0
	2	0	0	2	69.76	0
	2	0	0	2	38.05	0
	2	0	0	2	70	0
	2	0	0	2	1.7	0
	2	0	0	2	70	0
	2	0	0	2	38.05	0
	2	0	0	2	38.05	0
	2	0	0	2	46	0
	2	0	0	2	46	0
	2	0	0	2	1.8	0
	2	0	0	2	38.05	0
	2	0	0	2	38.05	0
	2	0	0	2	60	0
	2	0	0	2	46	0
	2	0	0	2	46	0
	2	0	0	2	38.05	0
	2	0	0	2	60	0
	2	0	0	2	1.9	0
	2	0	0	2	2.1	0
	2	0	0	2	38.05	0
	2	0	0	2	69.76	0
	2	0	0	2	2.2	0
	2	0	0	2	38.05	0
	2	0	0	2	53.66	0
	2	0	0	2	38.05	0
	];					

% let's fix this - create data with only one generator per node:

gen_count = 1;
unique_gen_count = 1;
gen_data_new = gen_data(1,:);
gencost_data_new = gencost_data(1,:);
gen_data_trunc = gen_data; % to be truncated
gencost_data_trunc = gencost_data; % to be truncated
gen_duplicates = [] % count duplicates of each gen
total_duplicates = 0; % count duplicates

gen_duplicates = [gen_data(1,1) 0]

for gen1 = 1:size(gen_data,1)
    gen1_bus = gen_data(gen1,1);
        
    contains_in_new_data = any(gen_data_new(:,1) == gen1_bus);
    if contains_in_new_data == 1;
        total_duplicates = total_duplicates + 1;
        gen_duplicates(unique_gen_count,1) = gen1_bus;
        gen_duplicates(unique_gen_count,2) = gen_duplicates(unique_gen_count,2) + 1;
        
        dup_Index = find(gen_data_new(:,1)==gen1_bus)
        gen_data_new(dup_Index,2:5) = gen_data_new(dup_Index,2:5) + gen_data(gen1,2:5);
        gen_data_new(dup_Index,9:10) = gen_data_new(dup_Index,9:10) + gen_data(gen1,9:10);
        gencost_data_new(dup_Index,5) = gencost_data_new(dup_Index,5) + gencost_data(gen1,5);
    else
        unique_gen_count = unique_gen_count + 1;
        gen_data_new = [gen_data_new;gen_data(gen1,:)];
        gencost_data_new = [gencost_data_new;gencost_data(gen1,:)];
        gen_duplicates = [gen_duplicates; [gen1_bus 1]]
    end
end

for gen_new = 1:size(gen_data_new,1)
    dup_Index = find(gen_duplicates(:,1)==gen_data_new(gen_new,1))
    if gen_duplicates(dup_Index,2) ~= 0
        gencost_data_new(gen_new,5) = gencost_data_new(gen_new,5)/gen_duplicates(dup_Index,2);
    end
end

% % Use this to increase gen capacity:
gen_data_new(:,4:5) = gen_data_new(:,4:5)*3
gen_data_new(:,9:10) = gen_data_new(:,9:10)*3

unique_gen_count
total_duplicates
    
